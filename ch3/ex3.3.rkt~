#lang sicp

;; Exercise 3.3

(define (make-account balance password)
  (define (withdraw amount)
    (cond ((>= balance amount) (set! balance (- balance amount)))
          (else ("Insufficient funds"))))
  (define (deposit amount)
    (set! balance (+ balance amount)))
  (define (dispatch x y)
    (cond ((not (eq? password y)) "Incorrect password")
          ((eq? x 'withdraw) withdraw)
          ((eq? x 'deposit) deposit)
          (else (error "Unknown request: make-account" x y)))))

(define acc (make-account 100 'secret-password))

((acc 'withdraw 'secret-password) 40)
